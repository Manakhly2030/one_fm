<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>api.mobile.roster API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>api.mobile.roster</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">import frappe
from frappe import _
from frappe.utils import getdate, cint, cstr, random_string, now_datetime
from frappe.client import get_list
import pandas as pd
import json, base64, ast, itertools, datetime
from frappe.client import attach_file
from one_fm.one_fm.page.roster.roster import get_post_view as _get_post_view#, get_roster_view as _get_roster_view

# @frappe.whitelist()
# def get_roster_view(start_date, end_date, all=1, assigned=0, scheduled=0, project=None, site=None, shift=None, department=None, operations_role=None):
#       try:
#               return _get_roster_view(start_date, end_date, all, assigned, scheduled, project, site, shift, department, operations_role)
#       except Exception as e:
#               return frappe.utils.response.report_error(e.http_status_code)

@frappe.whitelist()
def get_roster_view(date, shift=None, site=None, project=None, department=None):
        try:
                filters = {
                        &#39;date&#39;: date
                }
                if project:
                        filters.update({&#39;project&#39;: project})    
                if site:
                        filters.update({&#39;site&#39;: site})  
                if shift:
                        filters.update({&#39;shift&#39;: shift})        
                if department:
                        filters.update({&#39;department&#39;: department})      

                fields = [&#34;employee&#34;, &#34;employee_name&#34;, &#34;date&#34;, &#34;operations_role&#34;, &#34;post_abbrv&#34;, &#34;employee_availability&#34;, &#34;shift&#34;]
                user, user_roles, user_employee = get_current_user_details()
                print(user_roles)
                if &#34;Operations Manager&#34; in user_roles or &#34;Projects Manager&#34; in user_roles:
                        projects = get_assigned_projects(user_employee.name)
                        assigned_projects = []
                        for assigned_project in projects:
                                assigned_projects.append(assigned_project.name)

                        filters.update({&#34;project&#34;: (&#34;in&#34;, assigned_projects)})
                        roster = frappe.get_all(&#34;Employee Schedule&#34;, filters, fields)
                        master_data = []
                        for key, group in itertools.groupby(roster, key=lambda x: (x[&#39;post_abbrv&#39;], x[&#39;operations_role&#39;])):
                                employees = list(group)
                                master_data.append({&#34;employees&#34;: employees, &#34;post&#34;: key[0], &#34;count&#34;: len(employees)})
                        return master_data

                elif &#34;Site Supervisor&#34; in user_roles:
                        sites = get_assigned_sites(user_employee.name, project)
                        assigned_sites = []
                        for assigned_site in sites:
                                assigned_sites.append(assigned_site.name)
                        filters.update({&#34;site&#34;: (&#34;in&#34;, assigned_sites)})
                        roster = frappe.get_all(&#34;Employee Schedule&#34;, filters, fields)
                        print(roster)
                        master_data = []
                        for key, group in itertools.groupby(roster, key=lambda x: (x[&#39;post_abbrv&#39;], x[&#39;operations_role&#39;])):
                                employees = list(group)
                                master_data.append({&#34;employees&#34;: employees, &#34;post&#34;: key[0], &#34;count&#34;: len(employees)})
                        return master_data

                elif &#34;Shift Supervisor&#34; in user_roles:
                        shifts = get_assigned_shifts(user_employee.name, site)
                        assigned_shifts = []
                        for assigned_shift in shifts:
                                assigned_shifts.append(assigned_shift.name)
                        filters.update({&#34;shift&#34;:  (&#34;in&#34;, assigned_shifts)})

                        roster = frappe.get_all(&#34;Employee Schedule&#34;, filters, fields)
                        master_data = []
                        for key, group in itertools.groupby(roster, key=lambda x: (x[&#39;post_abbrv&#39;], x[&#39;operations_role&#39;])):
                                employees = list(group)
                                master_data.append({&#34;employees&#34;: employees, &#34;post&#34;: key[0], &#34;count&#34;: len(employees)})
                        return master_data
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)



@frappe.whitelist()
def get_weekly_staff_roster(start_date, end_date):
        try:
                user, user_roles, user_employee = get_current_user_details()
        
                roster = frappe.db.sql(&#34;&#34;&#34;
                        SELECT shift, employee, date, employee_availability, operations_role
                        FROM `tabEmployee Schedule`
                        WHERE employee=&#34;{emp}&#34;
                        AND date BETWEEN date(&#34;{start_date}&#34;) AND date(&#34;{end_date}&#34;)
                &#34;&#34;&#34;.format(emp=user_employee.name, start_date=start_date, end_date=end_date), as_dict=1)
                print(roster)
                return roster
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)


@frappe.whitelist()
def get_current_user_details():
        user = frappe.session.user
        user_roles = frappe.get_roles(user)
        user_employee = frappe.get_value(&#34;Employee&#34;, {&#34;user_id&#34;: user}, [&#34;name&#34;, &#34;employee_id&#34;, &#34;employee_name&#34;, &#34;image&#34;, &#34;enrolled&#34;, &#34;designation&#34;], as_dict=1)
        return user, user_roles, user_employee


@frappe.whitelist()
def get_post_view(date, shift=None, site=None, project=None, department=None):
        try:
                filters = {
                        &#39;date&#39;: date
                }
                if project:
                        filters.update({&#39;project&#39;: project})    
                if site:
                        filters.update({&#39;site&#39;: site})  
                if shift:
                        filters.update({&#39;shift&#39;: shift})        
                if department:
                        filters.update({&#39;department&#39;: department})      

                fields = [&#34;post&#34;, &#34;post_status&#34;, &#34;date&#34;, &#34;operations_role&#34;,  &#34;shift&#34;]
                user, user_roles, user_employee = get_current_user_details()

                if &#34;Operations Manager&#34; in user_roles or &#34;Projects Manager&#34; in user_roles:
                        projects = get_assigned_projects(user_employee.name)
                        assigned_projects = []
                        for assigned_project in projects:
                                assigned_projects.append(assigned_project.name)

                        filters.update({&#34;project&#34;: (&#34;in&#34;, assigned_projects)})
                        roster = frappe.get_all(&#34;Post Schedule&#34;, filters, fields)
                        print(roster)
                        for post in roster:
                                post.update({&#34;count&#34;: 1})
                        return roster

                elif &#34;Site Supervisor&#34; in user_roles:
                        sites = get_assigned_sites(user_employee.name, project)
                        assigned_sites = []
                        for assigned_site in sites:
                                assigned_sites.append(assigned_site.name)
                        filters.update({&#34;site&#34;: (&#34;in&#34;, assigned_sites)})
                        roster = frappe.get_all(&#34;Post Schedule&#34;, filters, fields)
                        print(roster)

                        master_data = []
                        # for key, group in itertools.groupby(roster, key=lambda x: (x[&#39;post_abbrv&#39;], x[&#39;operations_role&#39;])):
                        #       employees = list(group)
                        #       master_data.append({&#34;employees&#34;: employees, &#34;post&#34;: key[0], &#34;count&#34;: len(employees)})

                        for post in roster:
                                post.update({&#34;count&#34;: 1})
                        return roster

                elif &#34;Shift Supervisor&#34; in user_roles:
                        shifts = get_assigned_shifts(user_employee.name, site)
                        assigned_shifts = []
                        for assigned_shift in shifts:
                                assigned_shifts.append(assigned_shift.name)
                        filters.update({&#34;shift&#34;:  (&#34;in&#34;, assigned_shifts)})

                        roster = frappe.get_all(&#34;Post Schedule&#34;, filters, fields)
                        print(roster)
                        # for key, group in itertools.groupby(roster, key=lambda x: (x[&#39;post_abbrv&#39;], x[&#39;operations_role&#39;])):
                        #       employees = list(group)
                        #       master_data.append({&#34;employees&#34;: employees, &#34;post&#34;: key[0], &#34;count&#34;: len(employees)})
                        for post in roster:
                                post.update({&#34;count&#34;: 1})
                        return roster
                
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)


# @frappe.whitelist()
# def edit_post(operations_role, shift, post_status, date_list, paid=0, repeat=None):
#       &#34;&#34;&#34;
#               post_status: Post Off/Suspend Post/Cancel Post
#               date_list: List of dates
#               paid: 1/0 if the changes are paid/unpaid
#               repeat: If changes are to be repeated. List of dates when to repeat this.
#       &#34;&#34;&#34;
#       try:
#               date_list = json.loads(date_list)
#               for date in date_list:
#                       if frappe.db.exists(&#34;Post Schedule&#34;, {&#34;date&#34;: date, &#34;operations_role&#34;: operations_role, &#34;shift&#34;: shift}):
#                               post_schedule = frappe.get_doc(&#34;Post Schedule&#34;, {&#34;date&#34;: date, &#34;operations_role&#34;: operations_role, &#34;shift&#34;: shift})
#                       else:
#                               post_schedule = frappe.new_doc(&#34;Post Schedule&#34;)
#                               post_schedule.post = operations_role
#                               post_schedule.date = date
#                       post_schedule.post_status = post_status
#                       if cint(paid):
#                               print(&#34;81&#34;,post_schedule.paid,post_schedule.unpaid)
#                               post_schedule.paid = 1
#                               post_schedule.unpaid = 0
#                       else:
#                               print(&#34;85&#34;,post_schedule.paid,post_schedule.unpaid)
#                               post_schedule.unpaid = 1
#                               post_schedule.paid = 0
#                       post_schedule.save(ignore_permissions=True)
#                       # print(post_schedule.as_dict())
#               print(post_status, date_list, type(date_list))
#               frappe.db.commit()

#       except Exception as e:
#               return frappe.utils.response.report_error(e.http_status_code)

@frappe.whitelist()
def edit_post(post, post_status, start_date, end_date, paid=0, never_end=0, repeat=0, repeat_freq=None):
        try:
                if never_end:
                        project = frappe.get_value(&#34;Operations Post&#34;, post, [&#34;project&#34;])
                        end_date = frappe.get_value(&#34;Contracts&#34;, {&#34;project&#34;: project}, [&#34;end_date&#34;])
                if repeat:
                        if repeat_freq == &#34;Daily&#34;:
                                for date in     pd.date_range(start=start_date, end=end_date):
                                        create_edit_post(cstr(date.date()), post, post_status, paid)
                        elif repeat_freq == &#34;Weekly&#34;:
                                day = getdate(start_date).strftime(&#39;%A&#39;)
                                for date in     pd.date_range(start=start_date, end=end_date):
                                        if date.date().strftime(&#39;%A&#39;) == day:
                                                create_edit_post(cstr(date.date()), post, post_status, paid)
                        elif repeat_freq == &#34;Monthly&#34;:
                                for date in     month_range(start_date, end_date):
                                        # print(cstr(date.date()))
                                        if end_date &gt;= cstr(date.date()):
                                                print(cstr(date.date()))
                                                create_edit_post(cstr(date.date()), post, post_status, paid)
                else:
                        for date in     pd.date_range(start=start_date, end=end_date):
                                create_edit_post(cstr(date.date()), post, post_status, paid)
                frappe.db.commit()
                return True

        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)


def create_edit_post(date, post, post_status, paid):
        if frappe.db.exists(&#34;Post Schedule&#34;, {&#34;date&#34;: date, &#34;post&#34;: post}):
                post_schedule = frappe.get_doc(&#34;Post Schedule&#34;, {&#34;date&#34;: date, &#34;post&#34;: post})
        else:
                post_schedule = frappe.new_doc(&#34;Post Schedule&#34;)
                post_schedule.post = post
                post_schedule.date = date
        post_schedule.post_status = post_status
        if cint(paid):
                post_schedule.paid = 1
                post_schedule.unpaid = 0
        else:
                post_schedule.unpaid = 1
                post_schedule.paid = 0
        post_schedule.save(ignore_permissions=True)



@frappe.whitelist()
def day_off(employee, date, repeat=0, repeat_freq=None, repeat_till=None):
        try:
                if repeat:
                        if repeat_freq == &#34;Daily&#34;:
                                for date in     pd.date_range(start=date, end=repeat_till):
                                        create_day_off(employee, cstr(date.date()))
                        elif repeat_freq == &#34;Weekly&#34;:
                                day = getdate(date).strftime(&#39;%A&#39;)
                                for date in     pd.date_range(start=date, end=repeat_till):
                                        if date.date().strftime(&#39;%A&#39;) == day:
                                                create_day_off(employee, cstr(date.date()))
                        elif repeat_freq == &#34;Monthly&#34;:
                                for date in     month_range(date, repeat_till):
                                        # print(cstr(date.date()))
                                        if repeat_till &gt;= cstr(date.date()):
                                                print(cstr(date.date()))
                                                create_day_off(employee, cstr(date.date()))
                else:
                        create_day_off(employee, date)
                frappe.db.commit()
                return True
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)   


def month_range(start, end):
    rng = pd.date_range(start=pd.Timestamp(start)-pd.offsets.MonthBegin(),
                        end=end,
                        freq=&#39;MS&#39;)
    ret = (rng + pd.offsets.Day(pd.Timestamp(start).day-1)).to_series()
    ret.loc[ret.dt.month &gt; rng.month] -= pd.offsets.MonthEnd(1)
    return pd.DatetimeIndex(ret)


def create_day_off(employee, date):
        if frappe.db.exists(&#34;Employee Schedule&#34;, {&#34;employee&#34;: employee, &#34;date&#34;: date}):
                roster = frappe.get_doc(&#34;Employee Schedule&#34;, {&#34;employee&#34;: employee, &#34;date&#34;: date})
                roster.shift = None
                roster.shift_type = None
                roster.operations_role = None
                roster.post_abbrv = None
                roster.site = None
                roster.project = None
        else:
                roster = frappe.new_doc(&#34;Employee Schedule&#34;)
                roster.employee = employee
                roster.date = date
        roster.employee_availability = &#34;Day Off&#34;                                
        roster.save(ignore_permissions=True)


@frappe.whitelist()
def get_unassigned_project_employees(project, date, limit_start=None, limit_page_length=20):
        try:
                #Todo add date range
                return frappe.get_list(&#34;Employee&#34;, fields=[&#34;name&#34;, &#34;employee_name&#34;], filters={&#34;project&#34;: project}, order_by=&#34;name asc&#34;,
                        limit_start=limit_start, limit_page_length=limit_page_length, ignore_permissions=True)
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)   


@frappe.whitelist()
def get_unscheduled_employees(date, shift):
        try:
                employees = frappe.db.sql(&#34;&#34;&#34;
                        select name as employee_id, employee_name 
                        from `tabEmployee`
                        where 
                                shift=&#34;{shift}&#34;
                        and name not in(select employee from `tabEmployee Schedule` where date=&#34;{date}&#34; and shift=&#34;{shift}&#34;)
                &#34;&#34;&#34;.format(date=date, shift=shift), as_dict=1)
                return employees
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)   

@frappe.whitelist()
def get_assigned_employees(shift, date, limit_start=None, limit_page_length=20):
        try:
                #Todo add date range
                return frappe.get_list(&#34;Employee Schedule&#34;, fields=[&#34;employee&#34;, &#34;employee_name&#34;, &#34;operations_role&#34;], filters={&#34;shift&#34;: shift, &#34;date&#34;: date}, order_by=&#34;employee_name asc&#34;,
                        limit_start=limit_start, limit_page_length=limit_page_length, ignore_permissions=True)
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)


@frappe.whitelist()
def get_assigned_projects(employee_id):
        try:
                user, user_roles, user_employee = get_current_user_details()
                if &#34;Operations Manager&#34; in user_roles:
                        return frappe.get_list(&#34;Project&#34;, {&#34;project_type&#34;: &#34;External&#34;}, limit_page_length=9999, order_by=&#34;name asc&#34;)

                if &#34;Projects Manager&#34; in user_roles:
                        return frappe.get_list(&#34;Project&#34;, {&#34;account_manager&#34;: employee_id, &#34;project_type&#34;: &#34;External&#34;}, limit_page_length=9999, order_by=&#34;name asc&#34;)
                return []
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)
        

@frappe.whitelist()
def get_assigned_sites(employee_id, project=None):
        try:
                user, user_roles, user_employee = get_current_user_details()
                filters = {}
                if project:
                        filters.update({&#34;project&#34;: project})
                if project is None and (&#34;Operations Manager&#34; in user_roles or &#34;Projects Manager&#34; in user_roles or &#34;Site Supervisor&#34; in user_roles):
                        return frappe.get_list(&#34;Operations Site&#34;, limit_page_length=9999, order_by=&#34;name asc&#34;)

                elif &#34;Operations Manager&#34; in user_roles or &#34;Projects Manager&#34; in user_roles:
                        return frappe.get_list(&#34;Operations Site&#34;, filters, limit_page_length=9999, order_by=&#34;name asc&#34;)

                elif &#34;Site Supervisor&#34; in user_roles:
                        filters.update({&#34;account_supervisor&#34;: employee_id})
                        return frappe.get_list(&#34;Operations Site&#34;, filters, limit_page_length=9999, order_by=&#34;name asc&#34;)
                return []
        
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)
        

@frappe.whitelist()
def get_assigned_shifts(employee_id, project=None, site=None):
        try:
                user, user_roles, user_employee = get_current_user_details()
                filters = {}
                if project:
                        filters.update({&#34;project&#34;: project})
                if site:
                        filters.update({&#34;site&#34;: site})

                if site is None and (&#34;Operations Manager&#34; in user_roles or &#34;Projects Manager&#34; in user_roles or &#34;Site Supervisor&#34; in user_roles):
                        return frappe.get_list(&#34;Operations Shift&#34;, limit_page_length=9999, order_by=&#34;name asc&#34;)

                elif &#34;Operations Manager&#34; in user_roles or &#34;Projects Manager&#34; in user_roles or &#34;Site Supervisor&#34; in user_roles:
                        return frappe.get_list(&#34;Operations Shift&#34;, filters, limit_page_length=9999, order_by=&#34;name asc&#34;)

                elif &#34;Shift Supervisor&#34; in user_roles:
                        filters.update({&#34;supervisor&#34;: employee_id})
                        return frappe.get_list(&#34;Operations Shift&#34;, filters, limit_page_length=9999, order_by=&#34;name asc&#34;)
                return []
        
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)


@frappe.whitelist()
def get_departments():
        try:
                return frappe.get_list(&#34;Department&#34;,{&#34;is_group&#34;: 0}, limit_page_length=9999, order_by=&#34;name asc&#34;)
        
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)


@frappe.whitelist()
def get_operations_posts(shift=None):
        try:
                user, user_roles, user_employee = get_current_user_details()

                if shift is None and (&#34;Operations Manager&#34; in user_roles or &#34;Projects Manager&#34; in user_roles or &#34;Site Supervisor&#34; in user_roles):
                        return frappe.get_list(&#34;Operations Post&#34;, limit_page_length=9999, order_by=&#34;name asc&#34;)

                if &#34;Operations Manager&#34; in user_roles or &#34;Projects Manager&#34; in user_roles or &#34;Site Supervisor&#34; in user_roles or &#34;Shift Supervisor&#34; in user_roles:
                        return frappe.get_list(&#34;Operations Post&#34;, {&#34;site_shift&#34;: shift}, &#34;post_template&#34;, limit_page_length=9999, order_by=&#34;name asc&#34;)
                return []
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)

@frappe.whitelist()
def get_designations():
        try:
                return frappe.db.get_list(&#34;Designation&#34;, limit_page_length=9999, order_by=&#34;name asc&#34;)
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)   

@frappe.whitelist()
def get_post_details(post_name):
        try:
                return frappe.get_value(&#34;Operations Post&#34;, post_name, &#34;*&#34;)
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)


@frappe.whitelist()
def unschedule_staff(employee, start_date, end_date=None, never_end=0):
        try:
                if never_end:
                        rosters = frappe.get_all(&#34;Employee Schedule&#34;, {&#34;employee&#34;: employee,&#34;date&#34;: (&#39;&gt;=&#39;, start_date)})
                        for roster in rosters:
                                frappe.delete_doc(&#34;Employee Schedule&#34;, roster.name, ignore_permissions=True)
                        return True
                else:
                        for date in     pd.date_range(start=start_date, end=end_date):
                                if frappe.db.exists(&#34;Employee Schedule&#34;, {&#34;employee&#34;: employee, &#34;date&#34;:  cstr(date.date())}):
                                        roster = frappe.get_doc(&#34;Employee Schedule&#34;, {&#34;employee&#34;: employee, &#34;date&#34;:  cstr(date.date())})
                                        frappe.delete_doc(&#34;Employee Schedule&#34;, roster.name, ignore_permissions=True)
                        return True
        except Exception as e:
                print(e)
                return frappe.utils.response.report_error(e.http_status_code)


@frappe.whitelist()
def schedule_staff(employee, shift, operations_role, start_date, end_date=None, never=0, day_off=None):
        try:
                print(getdate(start_date).strftime(&#39;%A&#39;))
                # print(employee, shift, operations_role, start_date, end_date=None, never=0, day_off=None)
                if never:
                        end_date = cstr(getdate().year) + &#39;-12-31&#39;
                        print(end_date)
                        for date in     pd.date_range(start=start_date, end=end_date):
                                if frappe.db.exists(&#34;Employee Schedule&#34;, {&#34;employee&#34;: employee, &#34;date&#34;: cstr(date.date())}):
                                        roster = frappe.get_doc(&#34;Employee Schedule&#34;, {&#34;employee&#34;: employee, &#34;date&#34;: cstr(date.date())})
                                else:
                                        roster = frappe.new_doc(&#34;Employee Schedule&#34;)
                                        roster.employee = employee
                                        roster.date = cstr(date.date())
                                
                                if day_off and date.date().strftime(&#39;%A&#39;) == day_off:
                                        roster.employee_availability = &#34;Day Off&#34;                                
                                else:
                                        roster.employee_availability = &#34;Working&#34;
                                        roster.shift = shift
                                        roster.operations_role = operations_role
                                print(roster.as_dict())
                                roster.save(ignore_permissions=True)
                        return True
                else:           
                        for date in     pd.date_range(start=start_date, end=end_date):
                                if frappe.db.exists(&#34;Employee Schedule&#34;, {&#34;employee&#34;: employee, &#34;date&#34;:  cstr(date.date())}):
                                        roster = frappe.get_doc(&#34;Employee Schedule&#34;, {&#34;employee&#34;: employee, &#34;date&#34;:  cstr(date.date())})
                                else:
                                        roster = frappe.new_doc(&#34;Employee Schedule&#34;)
                                        roster.employee = employee
                                        roster.date =  cstr(date.date())
                                if day_off and date.date().strftime(&#39;%A&#39;) == day_off:
                                        roster.employee_availability = &#34;Day Off&#34;                                
                                else:
                                        roster.employee_availability = &#34;Working&#34;
                                        roster.shift = shift
                                        roster.operations_role = operations_role
                                        roster.operations_role = operations_role
                                print(roster.as_dict())
                                roster.save(ignore_permissions=True)
                        return True
        except Exception as e:
                frappe.log_error(e)
                frappe.throw(_(e))


@frappe.whitelist()
def schedule_leave(employee, leave_type, start_date, end_date):
        try:
                for date in     pd.date_range(start=start_date, end=end_date):
                        print(employee, date.date())
                        if frappe.db.exists(&#34;Employee Schedule&#34;, {&#34;employee&#34;: employee, &#34;date&#34;: cstr(date.date())}):
                                roster = frappe.get_doc(&#34;Employee Schedule&#34;, {&#34;employee&#34;: employee, &#34;date&#34;:  cstr(date.date())})
                                roster.shift = None
                                roster.shift_type = None
                                roster.project = None
                                roster.site = None
                        else:
                                roster = frappe.new_doc(&#34;Employee Schedule&#34;)
                                roster.employee = employee
                                roster.date =  cstr(date.date())
                        roster.employee_availability = leave_type
                        roster.save(ignore_permissions=True)
                return True
        except Exception as e:
                print(e)
                return frappe.utils.response.report_error(e.http_status_code)


@frappe.whitelist()
def post_handover(post, date, initiated_by, handover_to, docs_check, equipment_check, items_check, docs_comment=None, equipment_comment=None, items_comment=None, attachments=[]):
        try:
                handover = frappe.new_doc(&#34;Post Handover&#34;)
                handover.post = post
                handover.date = date
                handover.initiated_by = initiated_by
                handover.handover_to = handover_to
                handover.docs_check = docs_check
                handover.equipment_check = equipment_check
                handover.items_check = items_check
                handover.docs_comment = docs_comment
                handover.equipment_comment = equipment_comment
                handover.items_comment = items_comment
                handover.save()

                for attachment in ast.literal_eval(attachments):
                        attach_file(filename=random_string(6)+&#34;.jpg&#34;, filedata=base64.b64decode(attachment), doctype=handover.doctype, docname=handover.name)

                return True
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)


@frappe.whitelist()
def get_handover_posts(shift=None):
        try:
                filters = {&#34;handover&#34;: 1}
                if shift:
                        filters.update({&#34;site_shift&#34;: shift})
                return frappe.get_list(&#34;Operations Post&#34;, filters)
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)


@frappe.whitelist()
def get_current_shift(employee):
        &#34;&#34;&#34;This function is to return employee&#39;s current Shift,
        based on Shift Assignment. 

        Args:
                employee (str): Employee&#39;s ERP ID

        Returns:
                string: Operation Shift of the assigned shift if it exist.
        &#34;&#34;&#34;
        try:
                #fetch dates
                current_datetime = now_datetime().strftime(&#34;%Y-%m-%d %H:%M:%S&#34;)
                date, time = current_datetime.split(&#34; &#34;)
                prev_date = ((datetime.datetime.today() - datetime.timedelta(days=1)).strftime(&#34;%Y-%m-%d %H:%M:%S&#34;)).split(&#34; &#34;)[0]

                #fetch the last shift assignment
                last_shift = frappe.get_list(&#34;Shift Assignment&#34;,fields=[&#34;*&#34;],order_by=&#39;creation desc&#39;,limit_page_length=1)

                #convert to datetime
                time = time.split(&#34;:&#34;)
                time = datetime.timedelta(hours=cint(time[0]), minutes=cint(time[1]), seconds=cint(time[2]))
                
                if len(last_shift) &gt; 0:
                        shift = last_shift[0]
                        start_date = (shift.start_date).strftime(&#34;%Y-%m-%d&#34;)

                        #start date could be previous day if night shift
                        if start_date == date or start_date == prev_date:
                                start_time, end_time ,before_time, after_time= frappe.get_value(&#34;Shift Type&#34;, shift.shift_type, [&#34;start_time&#34;, &#34;end_time&#34;,&#34;begin_check_in_before_shift_start_time&#34;,&#34;allow_check_out_after_shift_end_time&#34;])
                                
                                #include early entry and late exit time
                                start_time = start_time - datetime.timedelta(minutes=before_time)
                                end_time = end_time + datetime.timedelta(minutes=after_time)
                                
                                #if start time is larger than end time, from either afternoon, evening or night shift.
                                if start_time &gt; end_time:
                                        if start_time &lt;= time &gt;= end_time or start_time &gt;= time &lt;= end_time:
                                                return shift
                                else:
                                        if start_time &lt;= time &lt;= end_time:
                                                return shift
        except Exception as e:
                print(frappe.get_traceback())
                return frappe.utils.response.report_error(e.http_status_code)


@frappe.whitelist()
def get_report_comments(report_name):
        try:
                comments = frappe.get_list(&#34;Comment&#34;, {&#34;reference_doctype&#34;: &#34;Shift Report&#34;, &#34;reference_name&#34;: report_name, &#34;comment_type&#34;: &#34;Comment&#34;}, &#34;*&#34;)
                return comments
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="api.mobile.roster.create_day_off"><code class="name flex">
<span>def <span class="ident">create_day_off</span></span>(<span>employee, date)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def create_day_off(employee, date):
        if frappe.db.exists(&#34;Employee Schedule&#34;, {&#34;employee&#34;: employee, &#34;date&#34;: date}):
                roster = frappe.get_doc(&#34;Employee Schedule&#34;, {&#34;employee&#34;: employee, &#34;date&#34;: date})
                roster.shift = None
                roster.shift_type = None
                roster.operations_role = None
                roster.post_abbrv = None
                roster.site = None
                roster.project = None
        else:
                roster = frappe.new_doc(&#34;Employee Schedule&#34;)
                roster.employee = employee
                roster.date = date
        roster.employee_availability = &#34;Day Off&#34;                                
        roster.save(ignore_permissions=True)</code></pre>
</details>
</dd>
<dt id="api.mobile.roster.create_edit_post"><code class="name flex">
<span>def <span class="ident">create_edit_post</span></span>(<span>date, post, post_status, paid)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def create_edit_post(date, post, post_status, paid):
        if frappe.db.exists(&#34;Post Schedule&#34;, {&#34;date&#34;: date, &#34;post&#34;: post}):
                post_schedule = frappe.get_doc(&#34;Post Schedule&#34;, {&#34;date&#34;: date, &#34;post&#34;: post})
        else:
                post_schedule = frappe.new_doc(&#34;Post Schedule&#34;)
                post_schedule.post = post
                post_schedule.date = date
        post_schedule.post_status = post_status
        if cint(paid):
                post_schedule.paid = 1
                post_schedule.unpaid = 0
        else:
                post_schedule.unpaid = 1
                post_schedule.paid = 0
        post_schedule.save(ignore_permissions=True)</code></pre>
</details>
</dd>
<dt id="api.mobile.roster.day_off"><code class="name flex">
<span>def <span class="ident">day_off</span></span>(<span>employee, date, repeat=0, repeat_freq=None, repeat_till=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@frappe.whitelist()
def day_off(employee, date, repeat=0, repeat_freq=None, repeat_till=None):
        try:
                if repeat:
                        if repeat_freq == &#34;Daily&#34;:
                                for date in     pd.date_range(start=date, end=repeat_till):
                                        create_day_off(employee, cstr(date.date()))
                        elif repeat_freq == &#34;Weekly&#34;:
                                day = getdate(date).strftime(&#39;%A&#39;)
                                for date in     pd.date_range(start=date, end=repeat_till):
                                        if date.date().strftime(&#39;%A&#39;) == day:
                                                create_day_off(employee, cstr(date.date()))
                        elif repeat_freq == &#34;Monthly&#34;:
                                for date in     month_range(date, repeat_till):
                                        # print(cstr(date.date()))
                                        if repeat_till &gt;= cstr(date.date()):
                                                print(cstr(date.date()))
                                                create_day_off(employee, cstr(date.date()))
                else:
                        create_day_off(employee, date)
                frappe.db.commit()
                return True
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)   </code></pre>
</details>
</dd>
<dt id="api.mobile.roster.edit_post"><code class="name flex">
<span>def <span class="ident">edit_post</span></span>(<span>post, post_status, start_date, end_date, paid=0, never_end=0, repeat=0, repeat_freq=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@frappe.whitelist()
def edit_post(post, post_status, start_date, end_date, paid=0, never_end=0, repeat=0, repeat_freq=None):
        try:
                if never_end:
                        project = frappe.get_value(&#34;Operations Post&#34;, post, [&#34;project&#34;])
                        end_date = frappe.get_value(&#34;Contracts&#34;, {&#34;project&#34;: project}, [&#34;end_date&#34;])
                if repeat:
                        if repeat_freq == &#34;Daily&#34;:
                                for date in     pd.date_range(start=start_date, end=end_date):
                                        create_edit_post(cstr(date.date()), post, post_status, paid)
                        elif repeat_freq == &#34;Weekly&#34;:
                                day = getdate(start_date).strftime(&#39;%A&#39;)
                                for date in     pd.date_range(start=start_date, end=end_date):
                                        if date.date().strftime(&#39;%A&#39;) == day:
                                                create_edit_post(cstr(date.date()), post, post_status, paid)
                        elif repeat_freq == &#34;Monthly&#34;:
                                for date in     month_range(start_date, end_date):
                                        # print(cstr(date.date()))
                                        if end_date &gt;= cstr(date.date()):
                                                print(cstr(date.date()))
                                                create_edit_post(cstr(date.date()), post, post_status, paid)
                else:
                        for date in     pd.date_range(start=start_date, end=end_date):
                                create_edit_post(cstr(date.date()), post, post_status, paid)
                frappe.db.commit()
                return True

        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)</code></pre>
</details>
</dd>
<dt id="api.mobile.roster.get_assigned_employees"><code class="name flex">
<span>def <span class="ident">get_assigned_employees</span></span>(<span>shift, date, limit_start=None, limit_page_length=20)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@frappe.whitelist()
def get_assigned_employees(shift, date, limit_start=None, limit_page_length=20):
        try:
                #Todo add date range
                return frappe.get_list(&#34;Employee Schedule&#34;, fields=[&#34;employee&#34;, &#34;employee_name&#34;, &#34;operations_role&#34;], filters={&#34;shift&#34;: shift, &#34;date&#34;: date}, order_by=&#34;employee_name asc&#34;,
                        limit_start=limit_start, limit_page_length=limit_page_length, ignore_permissions=True)
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)</code></pre>
</details>
</dd>
<dt id="api.mobile.roster.get_assigned_projects"><code class="name flex">
<span>def <span class="ident">get_assigned_projects</span></span>(<span>employee_id)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@frappe.whitelist()
def get_assigned_projects(employee_id):
        try:
                user, user_roles, user_employee = get_current_user_details()
                if &#34;Operations Manager&#34; in user_roles:
                        return frappe.get_list(&#34;Project&#34;, {&#34;project_type&#34;: &#34;External&#34;}, limit_page_length=9999, order_by=&#34;name asc&#34;)

                if &#34;Projects Manager&#34; in user_roles:
                        return frappe.get_list(&#34;Project&#34;, {&#34;account_manager&#34;: employee_id, &#34;project_type&#34;: &#34;External&#34;}, limit_page_length=9999, order_by=&#34;name asc&#34;)
                return []
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)</code></pre>
</details>
</dd>
<dt id="api.mobile.roster.get_assigned_shifts"><code class="name flex">
<span>def <span class="ident">get_assigned_shifts</span></span>(<span>employee_id, project=None, site=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@frappe.whitelist()
def get_assigned_shifts(employee_id, project=None, site=None):
        try:
                user, user_roles, user_employee = get_current_user_details()
                filters = {}
                if project:
                        filters.update({&#34;project&#34;: project})
                if site:
                        filters.update({&#34;site&#34;: site})

                if site is None and (&#34;Operations Manager&#34; in user_roles or &#34;Projects Manager&#34; in user_roles or &#34;Site Supervisor&#34; in user_roles):
                        return frappe.get_list(&#34;Operations Shift&#34;, limit_page_length=9999, order_by=&#34;name asc&#34;)

                elif &#34;Operations Manager&#34; in user_roles or &#34;Projects Manager&#34; in user_roles or &#34;Site Supervisor&#34; in user_roles:
                        return frappe.get_list(&#34;Operations Shift&#34;, filters, limit_page_length=9999, order_by=&#34;name asc&#34;)

                elif &#34;Shift Supervisor&#34; in user_roles:
                        filters.update({&#34;supervisor&#34;: employee_id})
                        return frappe.get_list(&#34;Operations Shift&#34;, filters, limit_page_length=9999, order_by=&#34;name asc&#34;)
                return []
        
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)</code></pre>
</details>
</dd>
<dt id="api.mobile.roster.get_assigned_sites"><code class="name flex">
<span>def <span class="ident">get_assigned_sites</span></span>(<span>employee_id, project=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@frappe.whitelist()
def get_assigned_sites(employee_id, project=None):
        try:
                user, user_roles, user_employee = get_current_user_details()
                filters = {}
                if project:
                        filters.update({&#34;project&#34;: project})
                if project is None and (&#34;Operations Manager&#34; in user_roles or &#34;Projects Manager&#34; in user_roles or &#34;Site Supervisor&#34; in user_roles):
                        return frappe.get_list(&#34;Operations Site&#34;, limit_page_length=9999, order_by=&#34;name asc&#34;)

                elif &#34;Operations Manager&#34; in user_roles or &#34;Projects Manager&#34; in user_roles:
                        return frappe.get_list(&#34;Operations Site&#34;, filters, limit_page_length=9999, order_by=&#34;name asc&#34;)

                elif &#34;Site Supervisor&#34; in user_roles:
                        filters.update({&#34;account_supervisor&#34;: employee_id})
                        return frappe.get_list(&#34;Operations Site&#34;, filters, limit_page_length=9999, order_by=&#34;name asc&#34;)
                return []
        
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)</code></pre>
</details>
</dd>
<dt id="api.mobile.roster.get_current_shift"><code class="name flex">
<span>def <span class="ident">get_current_shift</span></span>(<span>employee)</span>
</code></dt>
<dd>
<div class="desc"><p>This function is to return employee's current Shift,
based on Shift Assignment. </p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>employee</code></strong> :&ensp;<code>str</code></dt>
<dd>Employee's ERP ID</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>string</code></dt>
<dd>Operation Shift of the assigned shift if it exist.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@frappe.whitelist()
def get_current_shift(employee):
        &#34;&#34;&#34;This function is to return employee&#39;s current Shift,
        based on Shift Assignment. 

        Args:
                employee (str): Employee&#39;s ERP ID

        Returns:
                string: Operation Shift of the assigned shift if it exist.
        &#34;&#34;&#34;
        try:
                #fetch dates
                current_datetime = now_datetime().strftime(&#34;%Y-%m-%d %H:%M:%S&#34;)
                date, time = current_datetime.split(&#34; &#34;)
                prev_date = ((datetime.datetime.today() - datetime.timedelta(days=1)).strftime(&#34;%Y-%m-%d %H:%M:%S&#34;)).split(&#34; &#34;)[0]

                #fetch the last shift assignment
                last_shift = frappe.get_list(&#34;Shift Assignment&#34;,fields=[&#34;*&#34;],order_by=&#39;creation desc&#39;,limit_page_length=1)

                #convert to datetime
                time = time.split(&#34;:&#34;)
                time = datetime.timedelta(hours=cint(time[0]), minutes=cint(time[1]), seconds=cint(time[2]))
                
                if len(last_shift) &gt; 0:
                        shift = last_shift[0]
                        start_date = (shift.start_date).strftime(&#34;%Y-%m-%d&#34;)

                        #start date could be previous day if night shift
                        if start_date == date or start_date == prev_date:
                                start_time, end_time ,before_time, after_time= frappe.get_value(&#34;Shift Type&#34;, shift.shift_type, [&#34;start_time&#34;, &#34;end_time&#34;,&#34;begin_check_in_before_shift_start_time&#34;,&#34;allow_check_out_after_shift_end_time&#34;])
                                
                                #include early entry and late exit time
                                start_time = start_time - datetime.timedelta(minutes=before_time)
                                end_time = end_time + datetime.timedelta(minutes=after_time)
                                
                                #if start time is larger than end time, from either afternoon, evening or night shift.
                                if start_time &gt; end_time:
                                        if start_time &lt;= time &gt;= end_time or start_time &gt;= time &lt;= end_time:
                                                return shift
                                else:
                                        if start_time &lt;= time &lt;= end_time:
                                                return shift
        except Exception as e:
                print(frappe.get_traceback())
                return frappe.utils.response.report_error(e.http_status_code)</code></pre>
</details>
</dd>
<dt id="api.mobile.roster.get_current_user_details"><code class="name flex">
<span>def <span class="ident">get_current_user_details</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@frappe.whitelist()
def get_current_user_details():
        user = frappe.session.user
        user_roles = frappe.get_roles(user)
        user_employee = frappe.get_value(&#34;Employee&#34;, {&#34;user_id&#34;: user}, [&#34;name&#34;, &#34;employee_id&#34;, &#34;employee_name&#34;, &#34;image&#34;, &#34;enrolled&#34;, &#34;designation&#34;], as_dict=1)
        return user, user_roles, user_employee</code></pre>
</details>
</dd>
<dt id="api.mobile.roster.get_departments"><code class="name flex">
<span>def <span class="ident">get_departments</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@frappe.whitelist()
def get_departments():
        try:
                return frappe.get_list(&#34;Department&#34;,{&#34;is_group&#34;: 0}, limit_page_length=9999, order_by=&#34;name asc&#34;)
        
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)</code></pre>
</details>
</dd>
<dt id="api.mobile.roster.get_designations"><code class="name flex">
<span>def <span class="ident">get_designations</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@frappe.whitelist()
def get_designations():
        try:
                return frappe.db.get_list(&#34;Designation&#34;, limit_page_length=9999, order_by=&#34;name asc&#34;)
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)   </code></pre>
</details>
</dd>
<dt id="api.mobile.roster.get_handover_posts"><code class="name flex">
<span>def <span class="ident">get_handover_posts</span></span>(<span>shift=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@frappe.whitelist()
def get_handover_posts(shift=None):
        try:
                filters = {&#34;handover&#34;: 1}
                if shift:
                        filters.update({&#34;site_shift&#34;: shift})
                return frappe.get_list(&#34;Operations Post&#34;, filters)
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)</code></pre>
</details>
</dd>
<dt id="api.mobile.roster.get_operations_posts"><code class="name flex">
<span>def <span class="ident">get_operations_posts</span></span>(<span>shift=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@frappe.whitelist()
def get_operations_posts(shift=None):
        try:
                user, user_roles, user_employee = get_current_user_details()

                if shift is None and (&#34;Operations Manager&#34; in user_roles or &#34;Projects Manager&#34; in user_roles or &#34;Site Supervisor&#34; in user_roles):
                        return frappe.get_list(&#34;Operations Post&#34;, limit_page_length=9999, order_by=&#34;name asc&#34;)

                if &#34;Operations Manager&#34; in user_roles or &#34;Projects Manager&#34; in user_roles or &#34;Site Supervisor&#34; in user_roles or &#34;Shift Supervisor&#34; in user_roles:
                        return frappe.get_list(&#34;Operations Post&#34;, {&#34;site_shift&#34;: shift}, &#34;post_template&#34;, limit_page_length=9999, order_by=&#34;name asc&#34;)
                return []
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)</code></pre>
</details>
</dd>
<dt id="api.mobile.roster.get_post_details"><code class="name flex">
<span>def <span class="ident">get_post_details</span></span>(<span>post_name)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@frappe.whitelist()
def get_post_details(post_name):
        try:
                return frappe.get_value(&#34;Operations Post&#34;, post_name, &#34;*&#34;)
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)</code></pre>
</details>
</dd>
<dt id="api.mobile.roster.get_post_view"><code class="name flex">
<span>def <span class="ident">get_post_view</span></span>(<span>date, shift=None, site=None, project=None, department=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@frappe.whitelist()
def get_post_view(date, shift=None, site=None, project=None, department=None):
        try:
                filters = {
                        &#39;date&#39;: date
                }
                if project:
                        filters.update({&#39;project&#39;: project})    
                if site:
                        filters.update({&#39;site&#39;: site})  
                if shift:
                        filters.update({&#39;shift&#39;: shift})        
                if department:
                        filters.update({&#39;department&#39;: department})      

                fields = [&#34;post&#34;, &#34;post_status&#34;, &#34;date&#34;, &#34;operations_role&#34;,  &#34;shift&#34;]
                user, user_roles, user_employee = get_current_user_details()

                if &#34;Operations Manager&#34; in user_roles or &#34;Projects Manager&#34; in user_roles:
                        projects = get_assigned_projects(user_employee.name)
                        assigned_projects = []
                        for assigned_project in projects:
                                assigned_projects.append(assigned_project.name)

                        filters.update({&#34;project&#34;: (&#34;in&#34;, assigned_projects)})
                        roster = frappe.get_all(&#34;Post Schedule&#34;, filters, fields)
                        print(roster)
                        for post in roster:
                                post.update({&#34;count&#34;: 1})
                        return roster

                elif &#34;Site Supervisor&#34; in user_roles:
                        sites = get_assigned_sites(user_employee.name, project)
                        assigned_sites = []
                        for assigned_site in sites:
                                assigned_sites.append(assigned_site.name)
                        filters.update({&#34;site&#34;: (&#34;in&#34;, assigned_sites)})
                        roster = frappe.get_all(&#34;Post Schedule&#34;, filters, fields)
                        print(roster)

                        master_data = []
                        # for key, group in itertools.groupby(roster, key=lambda x: (x[&#39;post_abbrv&#39;], x[&#39;operations_role&#39;])):
                        #       employees = list(group)
                        #       master_data.append({&#34;employees&#34;: employees, &#34;post&#34;: key[0], &#34;count&#34;: len(employees)})

                        for post in roster:
                                post.update({&#34;count&#34;: 1})
                        return roster

                elif &#34;Shift Supervisor&#34; in user_roles:
                        shifts = get_assigned_shifts(user_employee.name, site)
                        assigned_shifts = []
                        for assigned_shift in shifts:
                                assigned_shifts.append(assigned_shift.name)
                        filters.update({&#34;shift&#34;:  (&#34;in&#34;, assigned_shifts)})

                        roster = frappe.get_all(&#34;Post Schedule&#34;, filters, fields)
                        print(roster)
                        # for key, group in itertools.groupby(roster, key=lambda x: (x[&#39;post_abbrv&#39;], x[&#39;operations_role&#39;])):
                        #       employees = list(group)
                        #       master_data.append({&#34;employees&#34;: employees, &#34;post&#34;: key[0], &#34;count&#34;: len(employees)})
                        for post in roster:
                                post.update({&#34;count&#34;: 1})
                        return roster
                
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)</code></pre>
</details>
</dd>
<dt id="api.mobile.roster.get_report_comments"><code class="name flex">
<span>def <span class="ident">get_report_comments</span></span>(<span>report_name)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@frappe.whitelist()
def get_report_comments(report_name):
        try:
                comments = frappe.get_list(&#34;Comment&#34;, {&#34;reference_doctype&#34;: &#34;Shift Report&#34;, &#34;reference_name&#34;: report_name, &#34;comment_type&#34;: &#34;Comment&#34;}, &#34;*&#34;)
                return comments
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)</code></pre>
</details>
</dd>
<dt id="api.mobile.roster.get_roster_view"><code class="name flex">
<span>def <span class="ident">get_roster_view</span></span>(<span>date, shift=None, site=None, project=None, department=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@frappe.whitelist()
def get_roster_view(date, shift=None, site=None, project=None, department=None):
        try:
                filters = {
                        &#39;date&#39;: date
                }
                if project:
                        filters.update({&#39;project&#39;: project})    
                if site:
                        filters.update({&#39;site&#39;: site})  
                if shift:
                        filters.update({&#39;shift&#39;: shift})        
                if department:
                        filters.update({&#39;department&#39;: department})      

                fields = [&#34;employee&#34;, &#34;employee_name&#34;, &#34;date&#34;, &#34;operations_role&#34;, &#34;post_abbrv&#34;, &#34;employee_availability&#34;, &#34;shift&#34;]
                user, user_roles, user_employee = get_current_user_details()
                print(user_roles)
                if &#34;Operations Manager&#34; in user_roles or &#34;Projects Manager&#34; in user_roles:
                        projects = get_assigned_projects(user_employee.name)
                        assigned_projects = []
                        for assigned_project in projects:
                                assigned_projects.append(assigned_project.name)

                        filters.update({&#34;project&#34;: (&#34;in&#34;, assigned_projects)})
                        roster = frappe.get_all(&#34;Employee Schedule&#34;, filters, fields)
                        master_data = []
                        for key, group in itertools.groupby(roster, key=lambda x: (x[&#39;post_abbrv&#39;], x[&#39;operations_role&#39;])):
                                employees = list(group)
                                master_data.append({&#34;employees&#34;: employees, &#34;post&#34;: key[0], &#34;count&#34;: len(employees)})
                        return master_data

                elif &#34;Site Supervisor&#34; in user_roles:
                        sites = get_assigned_sites(user_employee.name, project)
                        assigned_sites = []
                        for assigned_site in sites:
                                assigned_sites.append(assigned_site.name)
                        filters.update({&#34;site&#34;: (&#34;in&#34;, assigned_sites)})
                        roster = frappe.get_all(&#34;Employee Schedule&#34;, filters, fields)
                        print(roster)
                        master_data = []
                        for key, group in itertools.groupby(roster, key=lambda x: (x[&#39;post_abbrv&#39;], x[&#39;operations_role&#39;])):
                                employees = list(group)
                                master_data.append({&#34;employees&#34;: employees, &#34;post&#34;: key[0], &#34;count&#34;: len(employees)})
                        return master_data

                elif &#34;Shift Supervisor&#34; in user_roles:
                        shifts = get_assigned_shifts(user_employee.name, site)
                        assigned_shifts = []
                        for assigned_shift in shifts:
                                assigned_shifts.append(assigned_shift.name)
                        filters.update({&#34;shift&#34;:  (&#34;in&#34;, assigned_shifts)})

                        roster = frappe.get_all(&#34;Employee Schedule&#34;, filters, fields)
                        master_data = []
                        for key, group in itertools.groupby(roster, key=lambda x: (x[&#39;post_abbrv&#39;], x[&#39;operations_role&#39;])):
                                employees = list(group)
                                master_data.append({&#34;employees&#34;: employees, &#34;post&#34;: key[0], &#34;count&#34;: len(employees)})
                        return master_data
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)</code></pre>
</details>
</dd>
<dt id="api.mobile.roster.get_unassigned_project_employees"><code class="name flex">
<span>def <span class="ident">get_unassigned_project_employees</span></span>(<span>project, date, limit_start=None, limit_page_length=20)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@frappe.whitelist()
def get_unassigned_project_employees(project, date, limit_start=None, limit_page_length=20):
        try:
                #Todo add date range
                return frappe.get_list(&#34;Employee&#34;, fields=[&#34;name&#34;, &#34;employee_name&#34;], filters={&#34;project&#34;: project}, order_by=&#34;name asc&#34;,
                        limit_start=limit_start, limit_page_length=limit_page_length, ignore_permissions=True)
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)   </code></pre>
</details>
</dd>
<dt id="api.mobile.roster.get_unscheduled_employees"><code class="name flex">
<span>def <span class="ident">get_unscheduled_employees</span></span>(<span>date, shift)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@frappe.whitelist()
def get_unscheduled_employees(date, shift):
        try:
                employees = frappe.db.sql(&#34;&#34;&#34;
                        select name as employee_id, employee_name 
                        from `tabEmployee`
                        where 
                                shift=&#34;{shift}&#34;
                        and name not in(select employee from `tabEmployee Schedule` where date=&#34;{date}&#34; and shift=&#34;{shift}&#34;)
                &#34;&#34;&#34;.format(date=date, shift=shift), as_dict=1)
                return employees
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)   </code></pre>
</details>
</dd>
<dt id="api.mobile.roster.get_weekly_staff_roster"><code class="name flex">
<span>def <span class="ident">get_weekly_staff_roster</span></span>(<span>start_date, end_date)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@frappe.whitelist()
def get_weekly_staff_roster(start_date, end_date):
        try:
                user, user_roles, user_employee = get_current_user_details()
        
                roster = frappe.db.sql(&#34;&#34;&#34;
                        SELECT shift, employee, date, employee_availability, operations_role
                        FROM `tabEmployee Schedule`
                        WHERE employee=&#34;{emp}&#34;
                        AND date BETWEEN date(&#34;{start_date}&#34;) AND date(&#34;{end_date}&#34;)
                &#34;&#34;&#34;.format(emp=user_employee.name, start_date=start_date, end_date=end_date), as_dict=1)
                print(roster)
                return roster
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)</code></pre>
</details>
</dd>
<dt id="api.mobile.roster.month_range"><code class="name flex">
<span>def <span class="ident">month_range</span></span>(<span>start, end)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def month_range(start, end):
    rng = pd.date_range(start=pd.Timestamp(start)-pd.offsets.MonthBegin(),
                        end=end,
                        freq=&#39;MS&#39;)
    ret = (rng + pd.offsets.Day(pd.Timestamp(start).day-1)).to_series()
    ret.loc[ret.dt.month &gt; rng.month] -= pd.offsets.MonthEnd(1)
    return pd.DatetimeIndex(ret)</code></pre>
</details>
</dd>
<dt id="api.mobile.roster.post_handover"><code class="name flex">
<span>def <span class="ident">post_handover</span></span>(<span>post, date, initiated_by, handover_to, docs_check, equipment_check, items_check, docs_comment=None, equipment_comment=None, items_comment=None, attachments=[])</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@frappe.whitelist()
def post_handover(post, date, initiated_by, handover_to, docs_check, equipment_check, items_check, docs_comment=None, equipment_comment=None, items_comment=None, attachments=[]):
        try:
                handover = frappe.new_doc(&#34;Post Handover&#34;)
                handover.post = post
                handover.date = date
                handover.initiated_by = initiated_by
                handover.handover_to = handover_to
                handover.docs_check = docs_check
                handover.equipment_check = equipment_check
                handover.items_check = items_check
                handover.docs_comment = docs_comment
                handover.equipment_comment = equipment_comment
                handover.items_comment = items_comment
                handover.save()

                for attachment in ast.literal_eval(attachments):
                        attach_file(filename=random_string(6)+&#34;.jpg&#34;, filedata=base64.b64decode(attachment), doctype=handover.doctype, docname=handover.name)

                return True
        except Exception as e:
                return frappe.utils.response.report_error(e.http_status_code)</code></pre>
</details>
</dd>
<dt id="api.mobile.roster.schedule_leave"><code class="name flex">
<span>def <span class="ident">schedule_leave</span></span>(<span>employee, leave_type, start_date, end_date)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@frappe.whitelist()
def schedule_leave(employee, leave_type, start_date, end_date):
        try:
                for date in     pd.date_range(start=start_date, end=end_date):
                        print(employee, date.date())
                        if frappe.db.exists(&#34;Employee Schedule&#34;, {&#34;employee&#34;: employee, &#34;date&#34;: cstr(date.date())}):
                                roster = frappe.get_doc(&#34;Employee Schedule&#34;, {&#34;employee&#34;: employee, &#34;date&#34;:  cstr(date.date())})
                                roster.shift = None
                                roster.shift_type = None
                                roster.project = None
                                roster.site = None
                        else:
                                roster = frappe.new_doc(&#34;Employee Schedule&#34;)
                                roster.employee = employee
                                roster.date =  cstr(date.date())
                        roster.employee_availability = leave_type
                        roster.save(ignore_permissions=True)
                return True
        except Exception as e:
                print(e)
                return frappe.utils.response.report_error(e.http_status_code)</code></pre>
</details>
</dd>
<dt id="api.mobile.roster.schedule_staff"><code class="name flex">
<span>def <span class="ident">schedule_staff</span></span>(<span>employee, shift, operations_role, start_date, end_date=None, never=0, day_off=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@frappe.whitelist()
def schedule_staff(employee, shift, operations_role, start_date, end_date=None, never=0, day_off=None):
        try:
                print(getdate(start_date).strftime(&#39;%A&#39;))
                # print(employee, shift, operations_role, start_date, end_date=None, never=0, day_off=None)
                if never:
                        end_date = cstr(getdate().year) + &#39;-12-31&#39;
                        print(end_date)
                        for date in     pd.date_range(start=start_date, end=end_date):
                                if frappe.db.exists(&#34;Employee Schedule&#34;, {&#34;employee&#34;: employee, &#34;date&#34;: cstr(date.date())}):
                                        roster = frappe.get_doc(&#34;Employee Schedule&#34;, {&#34;employee&#34;: employee, &#34;date&#34;: cstr(date.date())})
                                else:
                                        roster = frappe.new_doc(&#34;Employee Schedule&#34;)
                                        roster.employee = employee
                                        roster.date = cstr(date.date())
                                
                                if day_off and date.date().strftime(&#39;%A&#39;) == day_off:
                                        roster.employee_availability = &#34;Day Off&#34;                                
                                else:
                                        roster.employee_availability = &#34;Working&#34;
                                        roster.shift = shift
                                        roster.operations_role = operations_role
                                print(roster.as_dict())
                                roster.save(ignore_permissions=True)
                        return True
                else:           
                        for date in     pd.date_range(start=start_date, end=end_date):
                                if frappe.db.exists(&#34;Employee Schedule&#34;, {&#34;employee&#34;: employee, &#34;date&#34;:  cstr(date.date())}):
                                        roster = frappe.get_doc(&#34;Employee Schedule&#34;, {&#34;employee&#34;: employee, &#34;date&#34;:  cstr(date.date())})
                                else:
                                        roster = frappe.new_doc(&#34;Employee Schedule&#34;)
                                        roster.employee = employee
                                        roster.date =  cstr(date.date())
                                if day_off and date.date().strftime(&#39;%A&#39;) == day_off:
                                        roster.employee_availability = &#34;Day Off&#34;                                
                                else:
                                        roster.employee_availability = &#34;Working&#34;
                                        roster.shift = shift
                                        roster.operations_role = operations_role
                                        roster.operations_role = operations_role
                                print(roster.as_dict())
                                roster.save(ignore_permissions=True)
                        return True
        except Exception as e:
                frappe.log_error(e)
                frappe.throw(_(e))</code></pre>
</details>
</dd>
<dt id="api.mobile.roster.unschedule_staff"><code class="name flex">
<span>def <span class="ident">unschedule_staff</span></span>(<span>employee, start_date, end_date=None, never_end=0)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@frappe.whitelist()
def unschedule_staff(employee, start_date, end_date=None, never_end=0):
        try:
                if never_end:
                        rosters = frappe.get_all(&#34;Employee Schedule&#34;, {&#34;employee&#34;: employee,&#34;date&#34;: (&#39;&gt;=&#39;, start_date)})
                        for roster in rosters:
                                frappe.delete_doc(&#34;Employee Schedule&#34;, roster.name, ignore_permissions=True)
                        return True
                else:
                        for date in     pd.date_range(start=start_date, end=end_date):
                                if frappe.db.exists(&#34;Employee Schedule&#34;, {&#34;employee&#34;: employee, &#34;date&#34;:  cstr(date.date())}):
                                        roster = frappe.get_doc(&#34;Employee Schedule&#34;, {&#34;employee&#34;: employee, &#34;date&#34;:  cstr(date.date())})
                                        frappe.delete_doc(&#34;Employee Schedule&#34;, roster.name, ignore_permissions=True)
                        return True
        except Exception as e:
                print(e)
                return frappe.utils.response.report_error(e.http_status_code)</code></pre>
</details>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="api.mobile" href="index.html">api.mobile</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="api.mobile.roster.create_day_off" href="#api.mobile.roster.create_day_off">create_day_off</a></code></li>
<li><code><a title="api.mobile.roster.create_edit_post" href="#api.mobile.roster.create_edit_post">create_edit_post</a></code></li>
<li><code><a title="api.mobile.roster.day_off" href="#api.mobile.roster.day_off">day_off</a></code></li>
<li><code><a title="api.mobile.roster.edit_post" href="#api.mobile.roster.edit_post">edit_post</a></code></li>
<li><code><a title="api.mobile.roster.get_assigned_employees" href="#api.mobile.roster.get_assigned_employees">get_assigned_employees</a></code></li>
<li><code><a title="api.mobile.roster.get_assigned_projects" href="#api.mobile.roster.get_assigned_projects">get_assigned_projects</a></code></li>
<li><code><a title="api.mobile.roster.get_assigned_shifts" href="#api.mobile.roster.get_assigned_shifts">get_assigned_shifts</a></code></li>
<li><code><a title="api.mobile.roster.get_assigned_sites" href="#api.mobile.roster.get_assigned_sites">get_assigned_sites</a></code></li>
<li><code><a title="api.mobile.roster.get_current_shift" href="#api.mobile.roster.get_current_shift">get_current_shift</a></code></li>
<li><code><a title="api.mobile.roster.get_current_user_details" href="#api.mobile.roster.get_current_user_details">get_current_user_details</a></code></li>
<li><code><a title="api.mobile.roster.get_departments" href="#api.mobile.roster.get_departments">get_departments</a></code></li>
<li><code><a title="api.mobile.roster.get_designations" href="#api.mobile.roster.get_designations">get_designations</a></code></li>
<li><code><a title="api.mobile.roster.get_handover_posts" href="#api.mobile.roster.get_handover_posts">get_handover_posts</a></code></li>
<li><code><a title="api.mobile.roster.get_operations_posts" href="#api.mobile.roster.get_operations_posts">get_operations_posts</a></code></li>
<li><code><a title="api.mobile.roster.get_post_details" href="#api.mobile.roster.get_post_details">get_post_details</a></code></li>
<li><code><a title="api.mobile.roster.get_post_view" href="#api.mobile.roster.get_post_view">get_post_view</a></code></li>
<li><code><a title="api.mobile.roster.get_report_comments" href="#api.mobile.roster.get_report_comments">get_report_comments</a></code></li>
<li><code><a title="api.mobile.roster.get_roster_view" href="#api.mobile.roster.get_roster_view">get_roster_view</a></code></li>
<li><code><a title="api.mobile.roster.get_unassigned_project_employees" href="#api.mobile.roster.get_unassigned_project_employees">get_unassigned_project_employees</a></code></li>
<li><code><a title="api.mobile.roster.get_unscheduled_employees" href="#api.mobile.roster.get_unscheduled_employees">get_unscheduled_employees</a></code></li>
<li><code><a title="api.mobile.roster.get_weekly_staff_roster" href="#api.mobile.roster.get_weekly_staff_roster">get_weekly_staff_roster</a></code></li>
<li><code><a title="api.mobile.roster.month_range" href="#api.mobile.roster.month_range">month_range</a></code></li>
<li><code><a title="api.mobile.roster.post_handover" href="#api.mobile.roster.post_handover">post_handover</a></code></li>
<li><code><a title="api.mobile.roster.schedule_leave" href="#api.mobile.roster.schedule_leave">schedule_leave</a></code></li>
<li><code><a title="api.mobile.roster.schedule_staff" href="#api.mobile.roster.schedule_staff">schedule_staff</a></code></li>
<li><code><a title="api.mobile.roster.unschedule_staff" href="#api.mobile.roster.unschedule_staff">unschedule_staff</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>